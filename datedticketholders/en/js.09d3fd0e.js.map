{"version":3,"sources":["../../js/index.js"],"names":["mode","currentStep","maxGuestNum","agreeTnC","$stepsEl","isSmallViewport","isMediumViewport","console","log","mobileStickyMenu","$","window","width","on","toggleClass","offsetTop","renderGuestInput","guestForm","guestNum","value","removeClass","addClass","find","removeAttr","attr","rangeFill","test","navigator","userAgent","isIE","thumbSize","css","text","addEventListener","datepicker","format","templates","leftArrow","rightArrow","datePicked","val","template","html","n","append","replace","e","preventDefault","stepId","Number","slice","x","prev","forms","document","getElementsByClassName","Array","prototype","filter","call","form","event","checkValidity","stopPropagation","classList","add","parent","index","siblings","shuttleBusTimeSlot","off","isHidden","scrollTop","height","scrollHeight","setTimeout"],"mappings":"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","file":"js.09d3fd0e.js","sourceRoot":"..\\DatedTicketHolders\\en","sourcesContent":["var mode = \"development\";\r\nvar currentStep = 1;\r\nvar maxGuestNum = 4;\r\nvar agreeTnC = false;\r\nvar $stepsEl = null;\r\nvar isSmallViewport = false;\r\nvar isMediumViewport = false;\r\nconsole.log(mode);\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  function getViewport() {\r\n    // bootstrap layout definition\r\n    isSmallViewport = $(window).width() < 768;\r\n    isMediumViewport = $(window).width() < 992;\r\n  }\r\n\r\n  // mobile sticky menu setup\r\n  function mobileStickyMenu() {\r\n    getViewport();\r\n    if (isMediumViewport) {\r\n      $stepsEl = $('.form-layer.active .mobile-steps');\r\n      $('.form-layer').on('scroll', function() {\r\n        $stepsEl.toggleClass('sticky', $stepsEl[0].offsetTop > 96)\r\n      });\r\n    }\r\n  }\r\n\r\n  // hide removed guest for user to restore it\r\n  function renderGuestInput() {\r\n    $('.guest-input-group:lt(' + guestForm.guestNum.value + ')').removeClass('d-none');\r\n    $('.guest-input-group:gt(' + (guestForm.guestNum.value - 1) + ')').addClass('d-none');\r\n    $('.guest-input-group.d-none').find('input').removeAttr('required');\r\n    $('.guest-input-group:not(.d-none)').find('input').attr('required','');\r\n  }\r\n\r\n  // fill up the range with width on dragging\r\n  function rangeFill() {\r\n    var isIE = /Trident|Edge/.test(window.navigator.userAgent);\r\n    var thumbSize = $(window).width() > 1366 ? '82px' : '60px';\r\n\r\n    // if (isIE) $('#range-container').css('height', '80px');\r\n\r\n    $('#range-fill').css('width',\r\n      guestForm.guestNum.value > 1\r\n        ? 'calc((((100% - ' + thumbSize + ') / 3) * ' + (guestForm.guestNum.value - 1) + ') + ' + thumbSize + ' - (' + thumbSize + ' / 2))'\r\n        : 0\r\n    );\r\n    $('#guest-num-value').text(guestForm.guestNum.value);\r\n  }\r\n\r\n  window.addEventListener('load', function() {\r\n    // datepicker initialzation\r\n    // reference: https://github.com/uxsolutions/bootstrap-datepicker\r\n    $('#datepicker').datepicker({\r\n      format: 'dd/mm/yyyy',\r\n      templates: {\r\n        leftArrow: '<i class=\"icon nav-arrow-left\"></i>',\r\n        rightArrow: '<i class=\"icon nav-arrow-right\"></i>'\r\n      }\r\n    });\r\n    $('#datepicker').on('changeDate', function() {\r\n      var datePicked = $('#datepicker').datepicker('getFormattedDate');\r\n      $('#my_hidden_input').val(datePicked);\r\n      $('#dateOfVisit').text(datePicked);\r\n    });\r\n\r\n    // render guest inputs based on number of guests in the form\r\n    var template = $('#guest-input-template').html();\r\n    for (var n=1; n <= maxGuestNum; n++) {\r\n      $(guestForm).find('#fieldsets').append(template.replace(/_Index/g, n));\r\n    }\r\n    renderGuestInput();\r\n    rangeFill();\r\n\r\n    // steps and step buttons listener\r\n    $('.step-btn').on('click', function(e) {\r\n      e.preventDefault();\r\n      if (!agreeTnC) return;\r\n      var stepId = $(this).attr('href');\r\n      if (stepId === '#form-step' + currentStep) return;\r\n      $('.form-layer').addClass('hidden').removeClass('active');\r\n      $(stepId).removeClass('hidden').addClass('active');\r\n      // inactive old step\r\n      $('#steps ul > li').removeClass('active');\r\n      $('.mobile-steps > li').removeClass('active');\r\n      // active new step\r\n      var currentStep = Number(stepId.slice(-1));\r\n      for (var x=1; x <= currentStep; x++) {\r\n        $('#steps ul > li[step=\"' + x + '\"]').addClass('active');\r\n        $('.mobile-steps > li[step=\"' + x + '\"]').addClass('active');\r\n      }\r\n      // get the current active element for mobile\r\n      $stepsEl = $('.form-layer.active .mobile-steps');\r\n    });\r\n\r\n    // input label movement based on input state\r\n    $('form input').on('focus', function(e) {\r\n      $(this).prev('.input-label').addClass('focus');\r\n    });\r\n    $('form input').on('blur', function(e) {\r\n      if (!this.value)\r\n        $(this).prev('.input-label').removeClass('focus');\r\n    });\r\n\r\n    // re-render guest input based on number of guests\r\n    // and fill up the range on dragging\r\n    $('#guest-num')\r\n      .on('change', function(e) {\r\n        renderGuestInput();\r\n      })\r\n      .on('input change', function(e) {\r\n        rangeFill();\r\n      });\r\n\r\n    $('#form-submit').on('click',function(e) {\r\n      // e.preventDefault();\r\n      // guestForm.submit();\r\n    });\r\n\r\n    // Fetch all the forms we want to apply custom Bootstrap validation styles to\r\n    var forms = document.getElementsByClassName('needs-validation');\r\n    // Loop over them and prevent submission\r\n    var validation = Array.prototype.filter.call(forms, function(form) {\r\n      form.addEventListener('submit', function(event) {\r\n        if (form.checkValidity() === false) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n        }\r\n        form.classList.add('was-validated');\r\n      }, false);\r\n    });\r\n  }, false);\r\n\r\n  // setup mobile menu based on viewport\r\n  mobileStickyMenu();\r\n\r\n  // animation control of ticket type button\r\n  $('#ticket-type-container .btn').on('mouseover', function(e) {\r\n    $(this).parent('.btn-group').attr('hover', $(this).index());\r\n  });\r\n  $('#ticket-type-container .btn').on('mouseout', function(e) {\r\n    $(this).parent('.btn-group').removeAttr('hover');\r\n  });\r\n\r\n  // timeslots\r\n  $('#time-slots .col').on('click', function(e) {\r\n    $(this).siblings('.active').removeClass('active');\r\n    $(this).addClass('active');\r\n    guestForm.shuttleBusTimeSlot.value = $(this).attr('value');\r\n    e.preventDefault();\r\n  });\r\n\r\n  // mobile only: show bottom shadow of sticky steps when scroll down\r\n  $(window).on('resize', function(e) {\r\n    $('.form-layer').off('scroll');\r\n    mobileStickyMenu();\r\n  });\r\n\r\n  // tnc scrolling handling\r\n  $('#form-step1').on('scroll', function() {\r\n    var isHidden = $(this).scrollTop() + $(this).height() > (this.scrollHeight - 298);  // 128 (btn row height) + 170 (reserved footer height)\r\n    \r\n    $('#fading-bg').toggleClass('d-none', isHidden);\r\n  });\r\n  \r\n  // agreen tnc\r\n  $('#agree-tnc').on('click', function(e) {\r\n    agreeTnC = true;\r\n    $('#steps, .mobile-steps').removeClass('disabled');\r\n    $(this).addClass('d-none');\r\n  });\r\n\r\n  // loading completed\r\n  setTimeout(function(e) {\r\n    $('body').removeClass('loading');\r\n  },500);\r\n})();"]}